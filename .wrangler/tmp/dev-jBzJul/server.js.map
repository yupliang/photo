{
  "version": 3,
  "sources": ["../bundle-83tkfD/checked-fetch.js", "../bundle-83tkfD/strip-cf-connecting-ip-header.js", "../../../src/glmClient.ts", "../../../src/server.ts", "../../../node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts", "../../../node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts", "../bundle-83tkfD/middleware-insertion-facade.js", "../../../node_modules/wrangler/templates/middleware/common.ts", "../bundle-83tkfD/middleware-loader.entry.ts"],
  "sourceRoot": "/Users/zhanghao/Desktop/photo/.wrangler/tmp/dev-jBzJul",
  "sourcesContent": ["const urls = new Set();\n\nfunction checkURL(request, init) {\n\tconst url =\n\t\trequest instanceof URL\n\t\t\t? request\n\t\t\t: new URL(\n\t\t\t\t\t(typeof request === \"string\"\n\t\t\t\t\t\t? new Request(request, init)\n\t\t\t\t\t\t: request\n\t\t\t\t\t).url\n\t\t\t\t);\n\tif (url.port && url.port !== \"443\" && url.protocol === \"https:\") {\n\t\tif (!urls.has(url.toString())) {\n\t\t\turls.add(url.toString());\n\t\t\tconsole.warn(\n\t\t\t\t`WARNING: known issue with \\`fetch()\\` requests to custom HTTPS ports in published Workers:\\n` +\n\t\t\t\t\t` - ${url.toString()} - the custom port will be ignored when the Worker is published using the \\`wrangler deploy\\` command.\\n`\n\t\t\t);\n\t\t}\n\t}\n}\n\nglobalThis.fetch = new Proxy(globalThis.fetch, {\n\tapply(target, thisArg, argArray) {\n\t\tconst [request, init] = argArray;\n\t\tcheckURL(request, init);\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n", "function stripCfConnectingIPHeader(input, init) {\n\tconst request = new Request(input, init);\n\trequest.headers.delete(\"CF-Connecting-IP\");\n\treturn request;\n}\n\nglobalThis.fetch = new Proxy(globalThis.fetch, {\n\tapply(target, thisArg, argArray) {\n\t\treturn Reflect.apply(target, thisArg, [\n\t\t\tstripCfConnectingIPHeader.apply(null, argArray),\n\t\t]);\n\t},\n});\n", "export async function analyzeImageBase64(\n  imageBase64: string,\n  apiKey: string\n): Promise<string> {\n  if (!apiKey) {\n    throw new Error(\"Missing BIGMODEL_API_KEY\");\n  }\n\n  const res = await fetch(\n    \"https://open.bigmodel.cn/api/paas/v4/chat/completions\",\n    {\n      method: \"POST\",\n      headers: {\n        Authorization: `Bearer ${apiKey}`,\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        model: \"glm-4v\",\n        messages: [\n          {\n            role: \"user\",\n            content: [\n              {\n                type: \"text\",\n                text: `\n\u4F60\u662F\u4E00\u540D\u53CB\u597D\u3001\u4E0D\u4F1A\u6253\u51FB\u4EBA\u7684\u6444\u5F71\u6559\u7EC3\u3002\n\u8BF7\u4ECE\u6784\u56FE\u3001\u5149\u7EBF\u3001\u4E3B\u4F53\u660E\u786E\u5EA6\u4E09\u4E2A\u65B9\u9762\uFF0C\n\u5206\u6790\u8FD9\u5F20\u7167\u7247\u7684\u4F18\u7F3A\u70B9\uFF0C\u5E76\u7ED9\u51FA\u4E0B\u6B21\u62CD\u6444\u5EFA\u8BAE\u3002\n                `.trim(),\n              },\n              {\n                type: \"image_url\",\n                image_url: {\n                  url: `data:image/jpeg;base64,${imageBase64}`,\n                },\n              },\n            ],\n          },\n        ],\n      }),\n    }\n  );\n\n  if (!res.ok) {\n    throw new Error(`API request failed: ${res.statusText}`);\n  }\n\n  const data = await res.json() as {\n    choices: Array<{\n      message: {\n        content: string;\n      };\n    }>;\n  };\n  return data.choices[0].message.content;\n}\n", "import { analyzeImageBase64 } from \"./glmClient\";\n\n// \u9884\u751F\u6210 HTML\uFF0C\u907F\u514D\u6BCF\u6B21\u8BF7\u6C42\u90FD\u91CD\u65B0\u751F\u6210\n// \u4F7F\u7528 try-catch \u786E\u4FDD\u6A21\u5757\u52A0\u8F7D\u65F6\u4E0D\u4F1A\u56E0\u4E3A HTML \u751F\u6210\u5931\u8D25\u800C\u5BFC\u81F4 Worker \u65E0\u6CD5\u542F\u52A8\nlet INDEX_HTML: string;\ntry {\n  INDEX_HTML = getIndexHTML();\n  console.log(\"[Worker \u521D\u59CB\u5316] HTML \u9884\u751F\u6210\u6210\u529F\");\n} catch (error) {\n  console.error(\"[Worker \u521D\u59CB\u5316] HTML \u9884\u751F\u6210\u5931\u8D25:\", error);\n  INDEX_HTML = \"<!DOCTYPE html><html><body><h1>\u670D\u52A1\u5668\u521D\u59CB\u5316\u9519\u8BEF</h1></body></html>\";\n}\n\n// Cloudflare Worker \u5165\u53E3\nexport default {\n  async fetch(request: Request, env: Env): Promise<Response> {\n    // \u8BE6\u7EC6\u7684\u8BF7\u6C42\u65E5\u5FD7\n    const url = new URL(request.url);\n    const startTime = Date.now();\n    const requestId = `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n    const method = request.method;\n    const pathname = url.pathname;\n    \n    console.log(`[${requestId}] ===== \u8BF7\u6C42\u5F00\u59CB =====`);\n    console.log(`[${requestId}] \u65F6\u95F4: ${new Date().toISOString()}`);\n    console.log(`[${requestId}] \u65B9\u6CD5: ${method}`);\n    console.log(`[${requestId}] URL: ${url.href}`);\n    console.log(`[${requestId}] \u8DEF\u5F84: ${pathname}`);\n    console.log(`[${requestId}] \u67E5\u8BE2\u53C2\u6570: ${url.search}`);\n\n    try {\n      // 1\uFE0F\u20E3 \u5904\u7406 GET / - \u8FD4\u56DE HTML \u9875\u9762\n      if (method === \"GET\" && (pathname === \"/\" || pathname === \"/index.html\")) {\n        console.log(`[${requestId}] \u2713 \u8FDB\u5165 HTML \u9875\u9762\u5206\u652F (GET /)`);\n        console.log(`[${requestId}] \u8FD4\u56DE\u9884\u751F\u6210\u7684 HTML\uFF0C\u957F\u5EA6: ${INDEX_HTML.length} \u5B57\u7B26`);\n        \n        // \u76F4\u63A5\u8FD4\u56DE\u9884\u751F\u6210\u7684 HTML\uFF0C\u4E0D\u6267\u884C\u4EFB\u4F55\u8BA1\u7B97\n        const response = new Response(INDEX_HTML, {\n          headers: { \n            \"Content-Type\": \"text/html; charset=utf-8\",\n            \"Cache-Control\": \"public, max-age=3600\"\n          },\n        });\n        \n        console.log(`[${requestId}] \u2713 HTML \u54CD\u5E94\u5DF2\u521B\u5EFA`);\n        return response;\n      }\n\n      // 2\uFE0F\u20E3 \u5904\u7406 POST /analyze - \u53EA\u5904\u7406\u56FE\u7247\u5206\u6790\n      if (method === \"POST\" && pathname === \"/analyze\") {\n        console.log(`[${requestId}] \u2713 \u8FDB\u5165\u56FE\u7247\u5206\u6790 API \u5206\u652F (POST /analyze)`);\n        const result = await handleAnalyze(request, env, requestId);\n        console.log(`[${requestId}] \u2713 \u5206\u6790\u8BF7\u6C42\u5904\u7406\u5B8C\u6210`);\n        return result;\n      }\n\n      // 3\uFE0F\u20E3 \u5176\u4ED6\u6240\u6709\u8BF7\u6C42\u8FD4\u56DE 404 Not Found\n      console.log(`[${requestId}] \u2717 \u8DEF\u7531\u672A\u5339\u914D (${method} ${pathname})\uFF0C\u8FD4\u56DE 404`);\n      return new Response(\"Not Found\", { \n        status: 404,\n        headers: { \"Content-Type\": \"text/plain\" }\n      });\n    } catch (error) {\n      console.error(`[${requestId}] \u2717\u2717\u2717 \u8BF7\u6C42\u5904\u7406\u5F02\u5E38 \u2717\u2717\u2717`);\n      console.error(`[${requestId}] \u9519\u8BEF\u7C7B\u578B:`, error instanceof Error ? error.constructor.name : typeof error);\n      console.error(`[${requestId}] \u9519\u8BEF\u6D88\u606F:`, error instanceof Error ? error.message : String(error));\n      console.error(`[${requestId}] \u9519\u8BEF\u5806\u6808:`, error instanceof Error ? error.stack : \"\u65E0\u5806\u6808\u4FE1\u606F\");\n      \n      const errorMessage = error instanceof Error ? error.message : \"\u5185\u90E8\u670D\u52A1\u5668\u9519\u8BEF\";\n      return new Response(\n        JSON.stringify({ \n          error: errorMessage,\n          requestId: requestId\n        }),\n        {\n          status: 500,\n          headers: { \"Content-Type\": \"application/json\" },\n        }\n      );\n    } finally {\n      const duration = Date.now() - startTime;\n      console.log(`[${requestId}] ===== \u8BF7\u6C42\u7ED3\u675F\uFF0C\u8017\u65F6: ${duration}ms =====`);\n    }\n  },\n};\n\nexport async function handleAnalyze(request: Request, env: Env, requestId: string): Promise<Response> {\n  try {\n    console.log(`[${requestId}] [handleAnalyze] \u5F00\u59CB\u5904\u7406\u5206\u6790\u8BF7\u6C42`);\n    \n    // \u68C0\u67E5\u73AF\u5883\u53D8\u91CF\n    if (!env.BIGMODEL_API_KEY) {\n      console.error(`[${requestId}] [handleAnalyze] BIGMODEL_API_KEY \u672A\u8BBE\u7F6E`);\n      return new Response(\n        JSON.stringify({ \n          error: \"\u670D\u52A1\u5668\u914D\u7F6E\u9519\u8BEF\uFF1AAPI Key \u672A\u8BBE\u7F6E\u3002\u8BF7\u4F7F\u7528 'wrangler secret put BIGMODEL_API_KEY' \u8BBE\u7F6E\u73AF\u5883\u53D8\u91CF\u3002\" \n        }),\n        {\n          status: 500,\n          headers: { \"Content-Type\": \"application/json\" },\n        }\n      );\n    }\n    console.log(`[${requestId}] [handleAnalyze] API Key \u5DF2\u914D\u7F6E\uFF08\u957F\u5EA6: ${env.BIGMODEL_API_KEY.length}\uFF09`);\n\n    console.log(`[${requestId}] [handleAnalyze] \u5F00\u59CB\u89E3\u6790 FormData`);\n    const formData = await request.formData();\n    console.log(`[${requestId}] [handleAnalyze] FormData \u89E3\u6790\u5B8C\u6210`);\n    \n    const fileEntry = formData.get(\"photo\");\n    console.log(`[${requestId}] [handleAnalyze] \u83B7\u53D6\u6587\u4EF6\u5B57\u6BB5: ${fileEntry ? (typeof fileEntry === \"string\" ? \"\u5B57\u7B26\u4E32\u7C7B\u578B\" : \"File \u7C7B\u578B\") : \"\u672A\u627E\u5230\"}`);\n\n    if (!fileEntry || typeof fileEntry === \"string\") {\n      console.log(`[${requestId}] [handleAnalyze] \u672A\u627E\u5230\u6709\u6548\u7684\u56FE\u7247\u6587\u4EF6`);\n      return new Response(\n        JSON.stringify({ error: \"\u8BF7\u4E0A\u4F20\u56FE\u7247\" }),\n        {\n          status: 400,\n          headers: { \"Content-Type\": \"application/json\" },\n        }\n      );\n    }\n\n    const file = fileEntry as File;\n    console.log(`[${requestId}] [handleAnalyze] \u56FE\u7247\u6587\u4EF6\u4FE1\u606F:`);\n    console.log(`[${requestId}]   - \u6587\u4EF6\u540D: ${file.name}`);\n    console.log(`[${requestId}]   - \u6587\u4EF6\u5927\u5C0F: ${file.size} bytes`);\n    console.log(`[${requestId}]   - \u6587\u4EF6\u7C7B\u578B: ${file.type}`);\n\n    // \u8BFB\u53D6\u6587\u4EF6\u5E76\u8F6C\u6362\u4E3A base64\n    console.log(`[${requestId}] [handleAnalyze] \u5F00\u59CB\u8BFB\u53D6\u6587\u4EF6\u5185\u5BB9`);\n    const arrayBuffer = await file.arrayBuffer();\n    console.log(`[${requestId}] [handleAnalyze] \u6587\u4EF6\u8BFB\u53D6\u5B8C\u6210\uFF0CArrayBuffer \u957F\u5EA6: ${arrayBuffer.byteLength}`);\n    \n    // \u5C06 ArrayBuffer \u8F6C\u6362\u4E3A base64\uFF08\u5206\u5757\u5904\u7406\u907F\u514D\u8C03\u7528\u6808\u6EA2\u51FA\uFF09\n    console.log(`[${requestId}] [handleAnalyze] \u5F00\u59CB\u8F6C\u6362\u4E3A base64`);\n    const bytes = new Uint8Array(arrayBuffer);\n    let binary = '';\n    const chunkSize = 8192; // \u6BCF\u6B21\u5904\u7406 8KB\n    const totalChunks = Math.ceil(bytes.length / chunkSize);\n    console.log(`[${requestId}] [handleAnalyze] \u9700\u8981\u5904\u7406 ${totalChunks} \u4E2A\u5757`);\n    \n    for (let i = 0; i < bytes.length; i += chunkSize) {\n      const chunk = bytes.subarray(i, i + chunkSize);\n      binary += String.fromCharCode.apply(null, Array.from(chunk));\n      if ((i / chunkSize) % 10 === 0) {\n        console.log(`[${requestId}] [handleAnalyze] \u8F6C\u6362\u8FDB\u5EA6: ${Math.round((i / bytes.length) * 100)}%`);\n      }\n    }\n    const imageBase64 = btoa(binary);\n    console.log(`[${requestId}] [handleAnalyze] Base64 \u8F6C\u6362\u5B8C\u6210\uFF0C\u957F\u5EA6: ${imageBase64.length} \u5B57\u7B26`);\n\n    // \u8C03\u7528 GLM-4V \u5206\u6790\uFF08\u4F20\u5165 env \u4EE5\u83B7\u53D6 API Key\uFF09\n    console.log(`[${requestId}] [handleAnalyze] \u5F00\u59CB\u8C03\u7528 GLM-4V API`);\n    const apiStartTime = Date.now();\n    const result = await analyzeImageBase64(imageBase64, env.BIGMODEL_API_KEY);\n    const apiDuration = Date.now() - apiStartTime;\n    console.log(`[${requestId}] [handleAnalyze] GLM-4V API \u8C03\u7528\u5B8C\u6210\uFF0C\u8017\u65F6: ${apiDuration}ms`);\n    console.log(`[${requestId}] [handleAnalyze] \u5206\u6790\u7ED3\u679C\u957F\u5EA6: ${result.length} \u5B57\u7B26`);\n\n    return new Response(\n      JSON.stringify({ result }),\n      {\n        headers: { \"Content-Type\": \"application/json\" },\n      }\n    );\n  } catch (error) {\n    console.error(`[${requestId}] [handleAnalyze] \u2717\u2717\u2717 \u5206\u6790\u5931\u8D25 \u2717\u2717\u2717`);\n    console.error(`[${requestId}] [handleAnalyze] \u9519\u8BEF\u7C7B\u578B:`, error instanceof Error ? error.constructor.name : typeof error);\n    console.error(`[${requestId}] [handleAnalyze] \u9519\u8BEF\u6D88\u606F:`, error instanceof Error ? error.message : String(error));\n    console.error(`[${requestId}] [handleAnalyze] \u9519\u8BEF\u5806\u6808:`, error instanceof Error ? error.stack : \"\u65E0\u5806\u6808\u4FE1\u606F\");\n    \n    return new Response(\n      JSON.stringify({\n        error: error instanceof Error ? error.message : \"\u5206\u6790\u5931\u8D25\",\n      }),\n      {\n        status: 500,\n        headers: { \"Content-Type\": \"application/json\" },\n      }\n    );\n  }\n}\n\nexport function getIndexHTML(): string {\n  return `<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>GLM-4V \u56FE\u7247\u5206\u6790</title>\n  <style>\n    * {\n      margin: 0;\n      padding: 0;\n      box-sizing: border-box;\n    }\n\n    body {\n      font-family: system-ui, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif;\n      background-color: #f5f5f7;\n      color: #1a1a1a;\n      line-height: 1.6;\n      padding: 40px 20px;\n      min-height: 100vh;\n    }\n\n    .container {\n      max-width: 680px;\n      margin: 0 auto;\n    }\n\n    h1 {\n      font-size: 28px;\n      font-weight: 600;\n      margin-bottom: 40px;\n      color: #1a1a1a;\n      text-align: center;\n    }\n\n    /* \u4E0A\u4F20\u533A\u57DF\u5361\u7247 */\n    .upload-card {\n      background: #ffffff;\n      border: 1px solid #e5e5e7;\n      border-radius: 12px;\n      padding: 32px;\n      margin-bottom: 24px;\n      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);\n    }\n\n    .upload-card-title {\n      font-size: 20px;\n      font-weight: 600;\n      margin-bottom: 24px;\n      color: #1a1a1a;\n    }\n\n    .file-input-wrapper {\n      position: relative;\n      display: inline-block;\n      width: 100%;\n      margin-bottom: 20px;\n    }\n\n    .file-input-label {\n      display: block;\n      padding: 14px 18px;\n      background: #f5f5f7;\n      border: 1px dashed #c0c0c2;\n      border-radius: 8px;\n      cursor: pointer;\n      font-size: 15px;\n      color: #4a4a4a;\n      text-align: center;\n      transition: all 0.2s ease;\n    }\n\n    .file-input-label:hover {\n      background: #eeeeef;\n      border-color: #a0a0a2;\n    }\n\n    #photoInput {\n      position: absolute;\n      opacity: 0;\n      width: 100%;\n      height: 100%;\n      cursor: pointer;\n    }\n\n    .image-preview {\n      margin-top: 20px;\n      display: none;\n      text-align: center;\n    }\n\n    .image-preview.show {\n      display: block;\n    }\n\n    .image-preview img {\n      max-width: 100%;\n      max-height: 400px;\n      border-radius: 8px;\n      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n    }\n\n    #analyzeBtn {\n      width: 100%;\n      padding: 14px 24px;\n      background: #1a1a1a;\n      color: #ffffff;\n      border: none;\n      border-radius: 8px;\n      font-size: 16px;\n      font-weight: 500;\n      cursor: pointer;\n      transition: all 0.2s ease;\n      margin-top: 20px;\n    }\n\n    #analyzeBtn:hover {\n      background: #2a2a2a;\n    }\n\n    #analyzeBtn:active {\n      background: #0a0a0a;\n      transform: translateY(1px);\n    }\n\n    #analyzeBtn:disabled {\n      background: #999;\n      cursor: not-allowed;\n      transform: none;\n    }\n\n    /* \u5206\u6790\u7ED3\u679C\u5361\u7247 */\n    .result-card {\n      background: #ffffff;\n      border: 1px solid #e5e5e7;\n      border-radius: 12px;\n      padding: 32px;\n      margin-top: 24px;\n      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);\n      display: none;\n    }\n\n    .result-card.show {\n      display: block;\n    }\n\n    .result-section {\n      margin-bottom: 32px;\n    }\n\n    .result-section:last-child {\n      margin-bottom: 0;\n    }\n\n    .section-title {\n      font-size: 18px;\n      font-weight: 600;\n      margin-bottom: 16px;\n      color: #1a1a1a;\n      padding-bottom: 12px;\n      border-bottom: 2px solid #f0f0f0;\n    }\n\n    .section-title.advantages {\n      color: #2e7d32;\n    }\n\n    .section-title.improvements {\n      color: #d84315;\n    }\n\n    .section-title.suggestions {\n      color: #1565c0;\n    }\n\n    .item-list {\n      list-style: none;\n      padding: 0;\n    }\n\n    .item-list li {\n      padding: 12px 0;\n      font-size: 15px;\n      line-height: 1.7;\n      color: #2a2a2a;\n      border-bottom: 1px solid #f5f5f7;\n    }\n\n    .item-list li:last-child {\n      border-bottom: none;\n    }\n\n    .item-list li::before {\n      content: \"\u2022\";\n      color: #999;\n      margin-right: 8px;\n      font-weight: bold;\n    }\n\n    .location-tag {\n      display: inline-block;\n      background: #f0f0f0;\n      color: #666;\n      padding: 2px 8px;\n      border-radius: 4px;\n      font-size: 12px;\n      margin-right: 8px;\n      font-weight: 500;\n    }\n\n    .loading-state {\n      text-align: center;\n      padding: 40px 20px;\n      color: #666;\n      font-size: 15px;\n    }\n\n    .error-state {\n      color: #d32f2f;\n      padding: 20px;\n      background: #ffebee;\n      border-radius: 8px;\n      font-size: 15px;\n    }\n\n    /* \u884C\u52A8\u5F15\u5BFC\u533A\u57DF */\n    .action-hint {\n      margin-top: 32px;\n      padding-top: 24px;\n      border-top: 1px solid #e8e8e8;\n      text-align: center;\n    }\n\n    .action-hint-text {\n      font-size: 14px;\n      color: #666;\n      margin-bottom: 16px;\n      line-height: 1.6;\n    }\n\n    .action-hint-text strong {\n      color: #1a1a1a;\n      font-weight: 600;\n    }\n\n    .action-button {\n      padding: 10px 20px;\n      background: #f5f5f7;\n      color: #1a1a1a;\n      border: 1px solid #d0d0d0;\n      border-radius: 6px;\n      font-size: 14px;\n      cursor: pointer;\n      transition: all 0.2s ease;\n    }\n\n    .action-button:hover {\n      background: #eeeeef;\n      border-color: #a0a0a0;\n    }\n\n    @media (max-width: 640px) {\n      body {\n        padding: 20px 16px;\n      }\n\n      h1 {\n        font-size: 24px;\n        margin-bottom: 32px;\n      }\n\n      .upload-card,\n      .result-card {\n        padding: 24px;\n      }\n    }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    <h1>GLM-4V \u56FE\u7247\u5206\u6790</h1>\n    \n    <!-- \u2460 \u4E0A\u4F20\u533A\u57DF -->\n    <div class=\"upload-card\">\n      <div class=\"upload-card-title\">\u4E0A\u4F20\u4E00\u5F20\u7167\u7247</div>\n      \n      <div class=\"file-input-wrapper\">\n        <label for=\"photoInput\" class=\"file-input-label\">\n          \u70B9\u51FB\u9009\u62E9\u56FE\u7247\u6587\u4EF6\n        </label>\n        <input type=\"file\" id=\"photoInput\" accept=\"image/*\">\n      </div>\n\n      <div class=\"image-preview\" id=\"imagePreview\">\n        <img id=\"previewImg\" alt=\"\u9884\u89C8\u56FE\u7247\">\n      </div>\n      \n      <button id=\"analyzeBtn\">\u5F00\u59CB\u5206\u6790</button>\n    </div>\n    \n    <!-- \u2461 \u5206\u6790\u7ED3\u679C\u533A\u57DF -->\n    <div class=\"result-card\" id=\"resultCard\">\n      <div id=\"loadingState\" class=\"loading-state\">\u5206\u6790\u4E2D\uFF0C\u8BF7\u7A0D\u5019...</div>\n      \n      <div id=\"resultContent\" style=\"display: none;\">\n        <!-- \u4F18\u70B9\u6A21\u5757 -->\n        <div class=\"result-section\" id=\"advantagesSection\" style=\"display: none;\">\n          <div class=\"section-title advantages\">\u7167\u7247\u4F18\u70B9</div>\n          <ul class=\"item-list\" id=\"advantagesList\"></ul>\n        </div>\n\n        <!-- \u6539\u8FDB\u6A21\u5757 -->\n        <div class=\"result-section\" id=\"improvementsSection\" style=\"display: none;\">\n          <div class=\"section-title improvements\">\u53EF\u4EE5\u6539\u8FDB\u7684\u5730\u65B9</div>\n          <ul class=\"item-list\" id=\"improvementsList\"></ul>\n        </div>\n\n        <!-- \u5EFA\u8BAE\u6A21\u5757 -->\n        <div class=\"result-section\" id=\"suggestionsSection\" style=\"display: none;\">\n          <div class=\"section-title suggestions\">\u4E0B\u6B21\u62CD\u6444\u5EFA\u8BAE</div>\n          <ul class=\"item-list\" id=\"suggestionsList\"></ul>\n        </div>\n\n        <!-- \u2462 \u884C\u52A8\u5F15\u5BFC\u533A\u57DF -->\n        <div class=\"action-hint\" id=\"actionHint\" style=\"display: none;\">\n          <div class=\"action-hint-text\" id=\"hintText\"></div>\n          <button class=\"action-button\" id=\"analyzeAnotherBtn\">\u6362\u4E00\u5F20\u518D\u5206\u6790</button>\n        </div>\n      </div>\n\n      <div id=\"errorState\" class=\"error-state\" style=\"display: none;\"></div>\n    </div>\n  </div>\n\n  <script>\n    const photoInput = document.getElementById(\"photoInput\");\n    const analyzeBtn = document.getElementById(\"analyzeBtn\");\n    const resultCard = document.getElementById(\"resultCard\");\n    const imagePreview = document.getElementById(\"imagePreview\");\n    const previewImg = document.getElementById(\"previewImg\");\n    const loadingState = document.getElementById(\"loadingState\");\n    const resultContent = document.getElementById(\"resultContent\");\n    const errorState = document.getElementById(\"errorState\");\n    const advantagesSection = document.getElementById(\"advantagesSection\");\n    const improvementsSection = document.getElementById(\"improvementsSection\");\n    const suggestionsSection = document.getElementById(\"suggestionsSection\");\n    const advantagesList = document.getElementById(\"advantagesList\");\n    const improvementsList = document.getElementById(\"improvementsList\");\n    const suggestionsList = document.getElementById(\"suggestionsList\");\n    const actionHint = document.getElementById(\"actionHint\");\n    const hintText = document.getElementById(\"hintText\");\n    const analyzeAnotherBtn = document.getElementById(\"analyzeAnotherBtn\");\n\n    // \u56FE\u7247\u9884\u89C8\n    photoInput.addEventListener(\"change\", (e) => {\n      const file = e.target.files[0];\n      if (file) {\n        const reader = new FileReader();\n        reader.onload = (event) => {\n          previewImg.src = event.target.result;\n          imagePreview.classList.add(\"show\");\n        };\n        reader.readAsDataURL(file);\n      } else {\n        imagePreview.classList.remove(\"show\");\n      }\n    });\n\n    // \u89E3\u6790\u5206\u6790\u7ED3\u679C\u6587\u672C\n    function parseAnalysisResult(text) {\n      const result = {\n        advantages: [],\n        improvements: [],\n        suggestions: []\n      };\n\n      // \u6309\u6BB5\u843D\u5206\u5272\n      const paragraphs = text.split(/\\\\n\\\\n+/).filter(p => p.trim());\n\n      let currentSection = null;\n\n      for (let para of paragraphs) {\n        para = para.trim();\n        \n        // \u8BC6\u522B\u4F18\u70B9\u90E8\u5206\n        if (para.match(/\u4F18\u70B9|\u4F18\u52BF|\u505A\u5F97\u597D\u7684\u5730\u65B9|\u4EAE\u70B9/i)) {\n          currentSection = 'advantages';\n          continue;\n        }\n        \n        // \u8BC6\u522B\u6539\u8FDB\u90E8\u5206\n        if (para.match(/\u6539\u8FDB|\u53EF\u4EE5\u6539\u8FDB|\u4E0D\u8DB3|\u95EE\u9898|\u9700\u8981/i)) {\n          currentSection = 'improvements';\n          continue;\n        }\n        \n        // \u8BC6\u522B\u5EFA\u8BAE\u90E8\u5206\n        if (para.match(/\u5EFA\u8BAE|\u4E0B\u6B21\u62CD\u6444|\u53EF\u4EE5\u5C1D\u8BD5|\u63A8\u8350/i)) {\n          currentSection = 'suggestions';\n          continue;\n        }\n\n        // \u63D0\u53D6\u5217\u8868\u9879\n        const items = para.split(/\\\\n/).filter(item => item.trim());\n        \n        for (let item of items) {\n          item = item.trim();\n          // \u79FB\u9664\u7F16\u53F7\u548C\u7B26\u53F7\n          item = item.replace(/^[\u2022\\\\-\\\\d\\\\.\u3001\uFF09)]+\\\\s*/, '');\n          \n          if (!item) continue;\n\n          // \u63D0\u53D6\u4F4D\u7F6E\u6807\u7B7E\uFF08\u5982\u3010\u4E3B\u4F53\u3011\u3010\u80CC\u666F\u3011\u7B49\uFF09\n          const locationMatch = item.match(/\u3010([^\u3011]+)\u3011/);\n          const location = locationMatch ? locationMatch[1] : null;\n          const content = item.replace(/\u3010[^\u3011]+\u3011/, '').trim();\n\n          const itemObj = { content, location };\n\n          if (currentSection === 'advantages') {\n            result.advantages.push(itemObj);\n          } else if (currentSection === 'improvements') {\n            result.improvements.push(itemObj);\n          } else if (currentSection === 'suggestions') {\n            result.suggestions.push(itemObj);\n          } else {\n            // \u5982\u679C\u6CA1\u6709\u660E\u786E\u5206\u7C7B\uFF0C\u5C1D\u8BD5\u6839\u636E\u5173\u952E\u8BCD\u5224\u65AD\n            if (item.match(/\u597D|\u4F18\u79C0|\u6E05\u6670|\u7A81\u51FA/i)) {\n              result.advantages.push(itemObj);\n            } else if (item.match(/\u6539\u8FDB|\u6CE8\u610F|\u8C03\u6574/i)) {\n              result.improvements.push(itemObj);\n            } else if (item.match(/\u5EFA\u8BAE|\u53EF\u4EE5|\u5C1D\u8BD5|\u4E0B\u6B21/i)) {\n              result.suggestions.push(itemObj);\n            }\n          }\n        }\n      }\n\n      // \u5982\u679C\u6CA1\u6709\u89E3\u6790\u5230\u5185\u5BB9\uFF0C\u5C1D\u8BD5\u66F4\u5BBD\u677E\u7684\u89E3\u6790\n      if (result.advantages.length === 0 && result.improvements.length === 0 && result.suggestions.length === 0) {\n        const lines = text.split(/\\\\n/).filter(l => l.trim());\n        lines.forEach(line => {\n          line = line.trim().replace(/^[\u2022\\\\-\\\\d\\\\.\u3001\uFF09)]+\\\\s*/, '');\n          if (line.match(/\u597D|\u4F18\u79C0|\u6E05\u6670|\u7A81\u51FA/i)) {\n            result.advantages.push({ content: line });\n          } else if (line.match(/\u6539\u8FDB|\u6CE8\u610F|\u8C03\u6574|\u4E0D\u8DB3/i)) {\n            result.improvements.push({ content: line });\n          } else if (line.match(/\u5EFA\u8BAE|\u53EF\u4EE5|\u5C1D\u8BD5|\u4E0B\u6B21/i)) {\n            result.suggestions.push({ content: line });\n          }\n        });\n      }\n\n      return result;\n    }\n\n    // \u6E32\u67D3\u5206\u6790\u7ED3\u679C\n    function renderResult(parsed) {\n      // \u9690\u85CF\u52A0\u8F7D\u72B6\u6001\n      loadingState.style.display = \"none\";\n      resultContent.style.display = \"block\";\n\n      // \u6E32\u67D3\u4F18\u70B9\n      if (parsed.advantages.length > 0) {\n        advantagesSection.style.display = \"block\";\n        advantagesList.innerHTML = parsed.advantages.map(item => \n          \\`<li>\\${item.content}</li>\\`\n        ).join('');\n      }\n\n      // \u6E32\u67D3\u6539\u8FDB\n      if (parsed.improvements.length > 0) {\n        improvementsSection.style.display = \"block\";\n        improvementsList.innerHTML = parsed.improvements.map(item => \n          \\`<li>\\${item.location ? \\`<span class=\"location-tag\">\u3010\\${item.location}\u3011</span>\\` : ''}\\${item.content}</li>\\`\n        ).join('');\n      }\n\n      // \u6E32\u67D3\u5EFA\u8BAE\n      if (parsed.suggestions.length > 0) {\n        suggestionsSection.style.display = \"block\";\n        suggestionsList.innerHTML = parsed.suggestions.map(item => \n          \\`<li>\\${item.content}</li>\\`\n        ).join('');\n      }\n\n      // \u663E\u793A\u884C\u52A8\u5F15\u5BFC\n      if (parsed.suggestions.length > 0) {\n        actionHint.style.display = \"block\";\n        hintText.innerHTML = \\`\u4E0B\u6B21\u62CD\u6444\u65F6\uFF0C\u4F18\u5148\u6CE8\u610F<strong>\u7B2C 1 \u6761\u5EFA\u8BAE</strong>\\`;\n      }\n    }\n\n    // \u5206\u6790\u6309\u94AE\u70B9\u51FB\n    analyzeBtn.addEventListener(\"click\", async () => {\n      const file = photoInput.files[0];\n      if (!file) {\n        resultCard.classList.add(\"show\");\n        errorState.style.display = \"block\";\n        errorState.textContent = \"\u8BF7\u5148\u9009\u62E9\u56FE\u7247\";\n        return;\n      }\n\n      // \u663E\u793A\u52A0\u8F7D\u72B6\u6001\n      resultCard.classList.add(\"show\");\n      loadingState.style.display = \"block\";\n      resultContent.style.display = \"none\";\n      errorState.style.display = \"none\";\n      analyzeBtn.disabled = true;\n\n      const formData = new FormData();\n      formData.append(\"photo\", file);\n\n      try {\n        const response = await fetch(\"/analyze\", {\n          method: \"POST\",\n          body: formData\n        });\n\n        const data = await response.json();\n        \n        if (response.ok) {\n          const result = data.result || \"\u65E0\u7ED3\u679C\";\n          const parsed = parseAnalysisResult(result);\n          renderResult(parsed);\n        } else {\n          errorState.style.display = \"block\";\n          errorState.textContent = \"\u9519\u8BEF: \" + (data.error || \"\u672A\u77E5\u9519\u8BEF\");\n        }\n      } catch (error) {\n        errorState.style.display = \"block\";\n        errorState.textContent = \"\u8BF7\u6C42\u5931\u8D25: \" + error.message;\n      } finally {\n        analyzeBtn.disabled = false;\n      }\n    });\n\n    // \u6362\u4E00\u5F20\u518D\u5206\u6790\n    analyzeAnotherBtn.addEventListener(\"click\", () => {\n      photoInput.value = \"\";\n      imagePreview.classList.remove(\"show\");\n      resultCard.classList.remove(\"show\");\n      photoInput.focus();\n    });\n  </script>\n</body>\n</html>`;\n}\n\n// \u7C7B\u578B\u5B9A\u4E49\nexport interface Env {\n  BIGMODEL_API_KEY: string;\n}\n", "import type { Middleware } from \"./common\";\n\nconst drainBody: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} finally {\n\t\ttry {\n\t\t\tif (request.body !== null && !request.bodyUsed) {\n\t\t\t\tconst reader = request.body.getReader();\n\t\t\t\twhile (!(await reader.read()).done) {}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Failed to drain the unused request body.\", e);\n\t\t}\n\t}\n};\n\nexport default drainBody;\n", "import type { Middleware } from \"./common\";\n\ninterface JsonError {\n\tmessage?: string;\n\tname?: string;\n\tstack?: string;\n\tcause?: JsonError;\n}\n\nfunction reduceError(e: any): JsonError {\n\treturn {\n\t\tname: e?.name,\n\t\tmessage: e?.message ?? String(e),\n\t\tstack: e?.stack,\n\t\tcause: e?.cause === undefined ? undefined : reduceError(e.cause),\n\t};\n}\n\n// See comment in `bundle.ts` for details on why this is needed\nconst jsonError: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} catch (e: any) {\n\t\tconst error = reduceError(e);\n\t\treturn Response.json(error, {\n\t\t\tstatus: 500,\n\t\t\theaders: { \"MF-Experimental-Error-Stack\": \"true\" },\n\t\t});\n\t}\n};\n\nexport default jsonError;\n", "\t\t\t\timport worker, * as OTHER_EXPORTS from \"/Users/zhanghao/Desktop/photo/src/server.ts\";\n\t\t\t\timport * as __MIDDLEWARE_0__ from \"/Users/zhanghao/Desktop/photo/node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts\";\nimport * as __MIDDLEWARE_1__ from \"/Users/zhanghao/Desktop/photo/node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts\";\n\n\t\t\t\texport * from \"/Users/zhanghao/Desktop/photo/src/server.ts\";\n\n\t\t\t\texport const __INTERNAL_WRANGLER_MIDDLEWARE__ = [\n\t\t\t\t\t\n\t\t\t\t\t__MIDDLEWARE_0__.default,__MIDDLEWARE_1__.default\n\t\t\t\t]\n\t\t\t\texport default worker;", "export type Awaitable<T> = T | Promise<T>;\n// TODO: allow dispatching more events?\nexport type Dispatcher = (\n\ttype: \"scheduled\",\n\tinit: { cron?: string }\n) => Awaitable<void>;\n\nexport type IncomingRequest = Request<\n\tunknown,\n\tIncomingRequestCfProperties<unknown>\n>;\n\nexport interface MiddlewareContext {\n\tdispatch: Dispatcher;\n\tnext(request: IncomingRequest, env: any): Awaitable<Response>;\n}\n\nexport type Middleware = (\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tmiddlewareCtx: MiddlewareContext\n) => Awaitable<Response>;\n\nconst __facade_middleware__: Middleware[] = [];\n\n// The register functions allow for the insertion of one or many middleware,\n// We register internal middleware first in the stack, but have no way of controlling\n// the order that addMiddleware is run in service workers so need an internal function.\nexport function __facade_register__(...args: (Middleware | Middleware[])[]) {\n\t__facade_middleware__.push(...args.flat());\n}\nexport function __facade_registerInternal__(\n\t...args: (Middleware | Middleware[])[]\n) {\n\t__facade_middleware__.unshift(...args.flat());\n}\n\nfunction __facade_invokeChain__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tmiddlewareChain: Middleware[]\n): Awaitable<Response> {\n\tconst [head, ...tail] = middlewareChain;\n\tconst middlewareCtx: MiddlewareContext = {\n\t\tdispatch,\n\t\tnext(newRequest, newEnv) {\n\t\t\treturn __facade_invokeChain__(newRequest, newEnv, ctx, dispatch, tail);\n\t\t},\n\t};\n\treturn head(request, env, ctx, middlewareCtx);\n}\n\nexport function __facade_invoke__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tfinalMiddleware: Middleware\n): Awaitable<Response> {\n\treturn __facade_invokeChain__(request, env, ctx, dispatch, [\n\t\t...__facade_middleware__,\n\t\tfinalMiddleware,\n\t]);\n}\n", "// This loads all middlewares exposed on the middleware object and then starts\n// the invocation chain. The big idea is that we can add these to the middleware\n// export dynamically through wrangler, or we can potentially let users directly\n// add them as a sort of \"plugin\" system.\n\nimport ENTRY, { __INTERNAL_WRANGLER_MIDDLEWARE__ } from \"/Users/zhanghao/Desktop/photo/.wrangler/tmp/bundle-83tkfD/middleware-insertion-facade.js\";\nimport { __facade_invoke__, __facade_register__, Dispatcher } from \"/Users/zhanghao/Desktop/photo/node_modules/wrangler/templates/middleware/common.ts\";\nimport type { WorkerEntrypointConstructor } from \"/Users/zhanghao/Desktop/photo/.wrangler/tmp/bundle-83tkfD/middleware-insertion-facade.js\";\n\n// Preserve all the exports from the worker\nexport * from \"/Users/zhanghao/Desktop/photo/.wrangler/tmp/bundle-83tkfD/middleware-insertion-facade.js\";\n\nclass __Facade_ScheduledController__ implements ScheduledController {\n\treadonly #noRetry: ScheduledController[\"noRetry\"];\n\n\tconstructor(\n\t\treadonly scheduledTime: number,\n\t\treadonly cron: string,\n\t\tnoRetry: ScheduledController[\"noRetry\"]\n\t) {\n\t\tthis.#noRetry = noRetry;\n\t}\n\n\tnoRetry() {\n\t\tif (!(this instanceof __Facade_ScheduledController__)) {\n\t\t\tthrow new TypeError(\"Illegal invocation\");\n\t\t}\n\t\t// Need to call native method immediately in case uncaught error thrown\n\t\tthis.#noRetry();\n\t}\n}\n\nfunction wrapExportedHandler(worker: ExportedHandler): ExportedHandler {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn worker;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\tconst fetchDispatcher: ExportedHandlerFetchHandler = function (\n\t\trequest,\n\t\tenv,\n\t\tctx\n\t) {\n\t\tif (worker.fetch === undefined) {\n\t\t\tthrow new Error(\"Handler does not export a fetch() function.\");\n\t\t}\n\t\treturn worker.fetch(request, env, ctx);\n\t};\n\n\treturn {\n\t\t...worker,\n\t\tfetch(request, env, ctx) {\n\t\t\tconst dispatcher: Dispatcher = function (type, init) {\n\t\t\t\tif (type === \"scheduled\" && worker.scheduled !== undefined) {\n\t\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\t\tDate.now(),\n\t\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t\t() => {}\n\t\t\t\t\t);\n\t\t\t\t\treturn worker.scheduled(controller, env, ctx);\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn __facade_invoke__(request, env, ctx, dispatcher, fetchDispatcher);\n\t\t},\n\t};\n}\n\nfunction wrapWorkerEntrypoint(\n\tklass: WorkerEntrypointConstructor\n): WorkerEntrypointConstructor {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn klass;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\t// `extend`ing `klass` here so other RPC methods remain callable\n\treturn class extends klass {\n\t\t#fetchDispatcher: ExportedHandlerFetchHandler<Record<string, unknown>> = (\n\t\t\trequest,\n\t\t\tenv,\n\t\t\tctx\n\t\t) => {\n\t\t\tthis.env = env;\n\t\t\tthis.ctx = ctx;\n\t\t\tif (super.fetch === undefined) {\n\t\t\t\tthrow new Error(\"Entrypoint class does not define a fetch() function.\");\n\t\t\t}\n\t\t\treturn super.fetch(request);\n\t\t};\n\n\t\t#dispatcher: Dispatcher = (type, init) => {\n\t\t\tif (type === \"scheduled\" && super.scheduled !== undefined) {\n\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\tDate.now(),\n\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t() => {}\n\t\t\t\t);\n\t\t\t\treturn super.scheduled(controller);\n\t\t\t}\n\t\t};\n\n\t\tfetch(request: Request<unknown, IncomingRequestCfProperties>) {\n\t\t\treturn __facade_invoke__(\n\t\t\t\trequest,\n\t\t\t\tthis.env,\n\t\t\t\tthis.ctx,\n\t\t\t\tthis.#dispatcher,\n\t\t\t\tthis.#fetchDispatcher\n\t\t\t);\n\t\t}\n\t};\n}\n\nlet WRAPPED_ENTRY: ExportedHandler | WorkerEntrypointConstructor | undefined;\nif (typeof ENTRY === \"object\") {\n\tWRAPPED_ENTRY = wrapExportedHandler(ENTRY);\n} else if (typeof ENTRY === \"function\") {\n\tWRAPPED_ENTRY = wrapWorkerEntrypoint(ENTRY);\n}\nexport default WRAPPED_ENTRY;\n"],
  "mappings": "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A;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAmiBT;AApiBgB;;;ACtLhB,IAAM,YAAwB,8BAAO,SAAS,KAAK,MAAM,kBAAkB;AAC1E,MAAI;AACH,WAAO,MAAM,cAAc,KAAK,SAAS,GAAG;AAAA,EAC7C,UAAE;AACD,QAAI;AACH,UAAI,QAAQ,SAAS,QAAQ,CAAC,QAAQ,UAAU;AAC/C,cAAM,SAAS,QAAQ,KAAK,UAAU;AACtC,eAAO,EAAE,MAAM,OAAO,KAAK,GAAG,MAAM;AAAA,QAAC;AAAA,MACtC;AAAA,IACD,SAAS,GAAP;AACD,cAAQ,MAAM,4CAA4C,CAAC;AAAA,IAC5D;AAAA,EACD;AACD,GAb8B;AAe9B,IAAO,6CAAQ;;;ACRf,SAAS,YAAY,GAAmB;AACvC,SAAO;AAAA,IACN,MAAM,GAAG;AAAA,IACT,SAAS,GAAG,WAAW,OAAO,CAAC;AAAA,IAC/B,OAAO,GAAG;AAAA,IACV,OAAO,GAAG,UAAU,SAAY,SAAY,YAAY,EAAE,KAAK;AAAA,EAChE;AACD;AAPS;AAUT,IAAM,YAAwB,8BAAO,SAAS,KAAK,MAAM,kBAAkB;AAC1E,MAAI;AACH,WAAO,MAAM,cAAc,KAAK,SAAS,GAAG;AAAA,EAC7C,SAAS,GAAP;AACD,UAAM,QAAQ,YAAY,CAAC;AAC3B,WAAO,SAAS,KAAK,OAAO;AAAA,MAC3B,QAAQ;AAAA,MACR,SAAS,EAAE,+BAA+B,OAAO;AAAA,IAClD,CAAC;AAAA,EACF;AACD,GAV8B;AAY9B,IAAO,2CAAQ;;;ACzBJ,IAAM,mCAAmC;AAAA,EAE9B;AAAA,EAAyB;AAC3C;AACA,IAAO,sCAAQ;;;ACcnB,IAAM,wBAAsC,CAAC;AAKtC,SAAS,uBAAuB,MAAqC;AAC3E,wBAAsB,KAAK,GAAG,KAAK,KAAK,CAAC;AAC1C;AAFgB;AAShB,SAAS,uBACR,SACA,KACA,KACA,UACA,iBACsB;AACtB,QAAM,CAAC,MAAM,GAAG,IAAI,IAAI;AACxB,QAAM,gBAAmC;AAAA,IACxC;AAAA,IACA,KAAK,YAAY,QAAQ;AACxB,aAAO,uBAAuB,YAAY,QAAQ,KAAK,UAAU,IAAI;AAAA,IACtE;AAAA,EACD;AACA,SAAO,KAAK,SAAS,KAAK,KAAK,aAAa;AAC7C;AAfS;AAiBF,SAAS,kBACf,SACA,KACA,KACA,UACA,iBACsB;AACtB,SAAO,uBAAuB,SAAS,KAAK,KAAK,UAAU;AAAA,IAC1D,GAAG;AAAA,IACH;AAAA,EACD,CAAC;AACF;AAXgB;;;AC3ChB,IAAM,iCAAN,MAAoE;AAAA,EAGnE,YACU,eACA,MACT,SACC;AAHQ;AACA;AAGT,SAAK,WAAW;AAAA,EACjB;AAAA,EARS;AAAA,EAUT,UAAU;AACT,QAAI,EAAE,gBAAgB,iCAAiC;AACtD,YAAM,IAAI,UAAU,oBAAoB;AAAA,IACzC;AAEA,SAAK,SAAS;AAAA,EACf;AACD;AAlBM;AAoBN,SAAS,oBAAoB,QAA0C;AAEtE,MACC,qCAAqC,UACrC,iCAAiC,WAAW,GAC3C;AACD,WAAO;AAAA,EACR;AAEA,aAAW,cAAc,kCAAkC;AAC1D,wBAAoB,UAAU;AAAA,EAC/B;AAEA,QAAM,kBAA+C,gCACpD,SACA,KACA,KACC;AACD,QAAI,OAAO,UAAU,QAAW;AAC/B,YAAM,IAAI,MAAM,6CAA6C;AAAA,IAC9D;AACA,WAAO,OAAO,MAAM,SAAS,KAAK,GAAG;AAAA,EACtC,GATqD;AAWrD,SAAO;AAAA,IACN,GAAG;AAAA,IACH,MAAM,SAAS,KAAK,KAAK;AACxB,YAAM,aAAyB,gCAAU,MAAM,MAAM;AACpD,YAAI,SAAS,eAAe,OAAO,cAAc,QAAW;AAC3D,gBAAM,aAAa,IAAI;AAAA,YACtB,KAAK,IAAI;AAAA,YACT,KAAK,QAAQ;AAAA,YACb,MAAM;AAAA,YAAC;AAAA,UACR;AACA,iBAAO,OAAO,UAAU,YAAY,KAAK,GAAG;AAAA,QAC7C;AAAA,MACD,GAT+B;AAU/B,aAAO,kBAAkB,SAAS,KAAK,KAAK,YAAY,eAAe;AAAA,IACxE;AAAA,EACD;AACD;AAxCS;AA0CT,SAAS,qBACR,OAC8B;AAE9B,MACC,qCAAqC,UACrC,iCAAiC,WAAW,GAC3C;AACD,WAAO;AAAA,EACR;AAEA,aAAW,cAAc,kCAAkC;AAC1D,wBAAoB,UAAU;AAAA,EAC/B;AAGA,SAAO,cAAc,MAAM;AAAA,IAC1B,mBAAyE,CACxE,SACA,KACA,QACI;AACJ,WAAK,MAAM;AACX,WAAK,MAAM;AACX,UAAI,MAAM,UAAU,QAAW;AAC9B,cAAM,IAAI,MAAM,sDAAsD;AAAA,MACvE;AACA,aAAO,MAAM,MAAM,OAAO;AAAA,IAC3B;AAAA,IAEA,cAA0B,CAAC,MAAM,SAAS;AACzC,UAAI,SAAS,eAAe,MAAM,cAAc,QAAW;AAC1D,cAAM,aAAa,IAAI;AAAA,UACtB,KAAK,IAAI;AAAA,UACT,KAAK,QAAQ;AAAA,UACb,MAAM;AAAA,UAAC;AAAA,QACR;AACA,eAAO,MAAM,UAAU,UAAU;AAAA,MAClC;AAAA,IACD;AAAA,IAEA,MAAM,SAAwD;AAC7D,aAAO;AAAA,QACN;AAAA,QACA,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,MACN;AAAA,IACD;AAAA,EACD;AACD;AAnDS;AAqDT,IAAI;AACJ,IAAI,OAAO,wCAAU,UAAU;AAC9B,kBAAgB,oBAAoB,mCAAK;AAC1C,WAAW,OAAO,wCAAU,YAAY;AACvC,kBAAgB,qBAAqB,mCAAK;AAC3C;AACA,IAAO,kCAAQ;",
  "names": []
}
